{"ast":null,"code":"import SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\nexport const initializeWebSocket = (url, onMessageReceived, nickname) => {\n  const socket = new SockJS(`http://${url}:8080/ws`);\n  const client = Stomp.over(socket);\n  client.connect({}, () => {\n    const sessionUrl = client.ws._transport.url;\n    const sessionId = extractSessionId(sessionUrl);\n    client.subscribe(`/queue/specific-user-${sessionUrl.split('/'[-2])}/${sessionUrl.split('/')}`, msg => {\n      onMessageReceived(JSON.parse(msg.body));\n    });\n    client.send('/app/chat.addUser', {}, nickname);\n  });\n  return client;\n};\nexport const disconnectWebSocket = client => {\n  if (client) {\n    client.disconnect();\n  }\n};\nconst extractSessionId = sessionUrl => {\n  console.log(sessionUrl);\n  const sessionIdMatch = sessionUrl.match(/\\/ws\\/([^/]+)\\/websocket/);\n  return sessionIdMatch ? sessionIdMatch[1] : 'unknown';\n};","map":{"version":3,"names":["SockJS","Stomp","initializeWebSocket","url","onMessageReceived","nickname","socket","client","over","connect","sessionUrl","ws","_transport","sessionId","extractSessionId","subscribe","split","msg","JSON","parse","body","send","disconnectWebSocket","disconnect","console","log","sessionIdMatch","match"],"sources":["/home/n/Desktop/privchat10.11.2024/privchatFrontend/src/services/WebSocketService.ts"],"sourcesContent":["import SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\n\nexport const initializeWebSocket = (url: string, onMessageReceived: (msg: any) => void, nickname: string) => {\n  const socket = new SockJS(`http://${url}:8080/ws`);\n  const client = Stomp.over(socket);\n\n  client.connect({}, () => {\n    const sessionUrl = client.ws._transport.url;\n    const sessionId = extractSessionId(sessionUrl);\n\n    client.subscribe(`/queue/specific-user-${sessionUrl.split('/'[-2])}/${sessionUrl.split('/')}`, (msg) => {\n      onMessageReceived(JSON.parse(msg.body));\n    });\n    client.send('/app/chat.addUser', {}, nickname);\n  });\n\n  return client;\n};\n\nexport const disconnectWebSocket = (client: any) => {\n  if (client) {\n    client.disconnect();\n  }\n};\n\nconst extractSessionId = (sessionUrl: string): string => {\n  console.log(sessionUrl)\n  const sessionIdMatch = sessionUrl.match(/\\/ws\\/([^/]+)\\/websocket/);\n  return sessionIdMatch ? sessionIdMatch[1] : 'unknown';\n};\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,eAAe;AAClC,SAASC,KAAK,QAAQ,gBAAgB;AAEtC,OAAO,MAAMC,mBAAmB,GAAGA,CAACC,GAAW,EAAEC,iBAAqC,EAAEC,QAAgB,KAAK;EAC3G,MAAMC,MAAM,GAAG,IAAIN,MAAM,CAAC,UAAUG,GAAG,UAAU,CAAC;EAClD,MAAMI,MAAM,GAAGN,KAAK,CAACO,IAAI,CAACF,MAAM,CAAC;EAEjCC,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM;IACvB,MAAMC,UAAU,GAAGH,MAAM,CAACI,EAAE,CAACC,UAAU,CAACT,GAAG;IAC3C,MAAMU,SAAS,GAAGC,gBAAgB,CAACJ,UAAU,CAAC;IAE9CH,MAAM,CAACQ,SAAS,CAAC,wBAAwBL,UAAU,CAACM,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAIN,UAAU,CAACM,KAAK,CAAC,GAAG,CAAC,EAAE,EAAGC,GAAG,IAAK;MACtGb,iBAAiB,CAACc,IAAI,CAACC,KAAK,CAACF,GAAG,CAACG,IAAI,CAAC,CAAC;IACzC,CAAC,CAAC;IACFb,MAAM,CAACc,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAEhB,QAAQ,CAAC;EAChD,CAAC,CAAC;EAEF,OAAOE,MAAM;AACf,CAAC;AAED,OAAO,MAAMe,mBAAmB,GAAIf,MAAW,IAAK;EAClD,IAAIA,MAAM,EAAE;IACVA,MAAM,CAACgB,UAAU,CAAC,CAAC;EACrB;AACF,CAAC;AAED,MAAMT,gBAAgB,GAAIJ,UAAkB,IAAa;EACvDc,OAAO,CAACC,GAAG,CAACf,UAAU,CAAC;EACvB,MAAMgB,cAAc,GAAGhB,UAAU,CAACiB,KAAK,CAAC,0BAA0B,CAAC;EACnE,OAAOD,cAAc,GAAGA,cAAc,CAAC,CAAC,CAAC,GAAG,SAAS;AACvD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}