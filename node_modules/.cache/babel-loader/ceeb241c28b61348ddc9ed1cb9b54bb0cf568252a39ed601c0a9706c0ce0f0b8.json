{"ast":null,"code":"import SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\nexport const initializeWebSocket = (url, onMessageReceived, nickname) => {\n  const socket = new SockJS(`http://${url}:8080/ws`);\n  const client = Stomp.over(socket);\n  client.connect({}, () => {\n    const sessionUrl = client.ws._transport.url;\n    const sessionId = extractSessionId(sessionUrl);\n    client.subscribe(`/queue/specific-user-${sessionId}`, msg => {\n      onMessageReceived(JSON.parse(msg.body));\n    });\n    client.send('/app/chat.addUser', {}, nickname);\n  });\n  return client;\n};\nexport const disconnectWebSocket = client => {\n  if (client) {\n    client.disconnect();\n  }\n};\nconst extractSessionId = url => {\n  return url.replace(`ws://${url}/ws/`, '').replace('/websocket', '').replace(/^[0-9]+\\//g, '');\n};","map":{"version":3,"names":["SockJS","Stomp","initializeWebSocket","url","onMessageReceived","nickname","socket","client","over","connect","sessionUrl","ws","_transport","sessionId","extractSessionId","subscribe","msg","JSON","parse","body","send","disconnectWebSocket","disconnect","replace"],"sources":["/home/n/Desktop/privchat10.11.2024/privchatFrontend/src/services/WebSocketService.ts"],"sourcesContent":["import SockJS from 'sockjs-client';\nimport { Stomp } from '@stomp/stompjs';\n\nexport const initializeWebSocket = (url: string, onMessageReceived: (msg: any) => void, nickname: string) => {\n  const socket = new SockJS(`http://${url}:8080/ws`);\n  const client = Stomp.over(socket);\n\n  client.connect({}, () => {\n    const sessionUrl = client.ws._transport.url;\n    const sessionId = extractSessionId(sessionUrl);\n    client.subscribe(`/queue/specific-user-${sessionId}`, (msg) => {\n      onMessageReceived(JSON.parse(msg.body));\n    });\n    client.send('/app/chat.addUser', {}, nickname);\n  });\n\n  return client;\n};\n\nexport const disconnectWebSocket = (client: any) => {\n  if (client) {\n    client.disconnect();\n  }\n};\n\nconst extractSessionId = (url: string): string => {\n  return url.replace(`ws://${url}/ws/`, '')\n            .replace('/websocket', '')\n            .replace(/^[0-9]+\\//g, '');\n};\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,eAAe;AAClC,SAASC,KAAK,QAAQ,gBAAgB;AAEtC,OAAO,MAAMC,mBAAmB,GAAGA,CAACC,GAAW,EAAEC,iBAAqC,EAAEC,QAAgB,KAAK;EAC3G,MAAMC,MAAM,GAAG,IAAIN,MAAM,CAAC,UAAUG,GAAG,UAAU,CAAC;EAClD,MAAMI,MAAM,GAAGN,KAAK,CAACO,IAAI,CAACF,MAAM,CAAC;EAEjCC,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM;IACvB,MAAMC,UAAU,GAAGH,MAAM,CAACI,EAAE,CAACC,UAAU,CAACT,GAAG;IAC3C,MAAMU,SAAS,GAAGC,gBAAgB,CAACJ,UAAU,CAAC;IAC9CH,MAAM,CAACQ,SAAS,CAAC,wBAAwBF,SAAS,EAAE,EAAGG,GAAG,IAAK;MAC7DZ,iBAAiB,CAACa,IAAI,CAACC,KAAK,CAACF,GAAG,CAACG,IAAI,CAAC,CAAC;IACzC,CAAC,CAAC;IACFZ,MAAM,CAACa,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC,EAAEf,QAAQ,CAAC;EAChD,CAAC,CAAC;EAEF,OAAOE,MAAM;AACf,CAAC;AAED,OAAO,MAAMc,mBAAmB,GAAId,MAAW,IAAK;EAClD,IAAIA,MAAM,EAAE;IACVA,MAAM,CAACe,UAAU,CAAC,CAAC;EACrB;AACF,CAAC;AAED,MAAMR,gBAAgB,GAAIX,GAAW,IAAa;EAChD,OAAOA,GAAG,CAACoB,OAAO,CAAC,QAAQpB,GAAG,MAAM,EAAE,EAAE,CAAC,CAC9BoB,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CACzBA,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC;AACtC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}